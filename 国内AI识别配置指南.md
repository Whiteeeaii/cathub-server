# 🇨🇳 国内 AI 识别配置指南

## 📋 重要说明

**Google Gemini 在中国大陆无法直接访问**，但我们提供了国内可用的替代方案！

---

## 🎯 推荐方案：阿里云通义千问 ⭐⭐⭐⭐⭐

### 为什么选择通义千问？

1. ✅ **国内可用**：无需代理，访问速度快
2. ✅ **免费额度充足**：每月 100 万 tokens
3. ✅ **准确度高**：与 Gemini 相当
4. ✅ **易于集成**：API 简单
5. ✅ **官方支持**：阿里云提供技术支持

---

## 🔑 获取阿里云通义千问 API Key

### 步骤 1：注册阿里云账号

访问：https://www.aliyun.com

- 如果已有阿里云账号，直接登录
- 如果没有，点击"免费注册"

### 步骤 2：开通 DashScope 服务

1. 访问：https://dashscope.aliyun.com
2. 点击"开通 DashScope"
3. 同意服务协议
4. 完成实名认证（需要身份证）

### 步骤 3：创建 API Key

1. 登录后，点击右上角头像
2. 选择"API-KEY 管理"
3. 点击"创建新的 API-KEY"
4. 复制生成的 API Key

**示例**：
```
sk-1234567890abcdefghijklmnopqrstuvwxyz
```

⚠️ **重要**：请妥善保管 API Key，不要分享给他人！

---

## ⚙️ 在 Render 上配置

### 步骤 1：登录 Render Dashboard

访问：https://dashboard.render.com

### 步骤 2：进入您的服务

点击 `cathub-backend` 服务

### 步骤 3：添加环境变量

1. 点击左侧 **"Environment"** 标签
2. 点击 **"Add Environment Variable"**
3. 添加以下两个变量：

**变量 1**：
- **Key**: `AI_PROVIDER`
- **Value**: `qwen`

**变量 2**：
- **Key**: `DASHSCOPE_API_KEY`
- **Value**: 粘贴您的阿里云 API Key

4. 点击 **"Save Changes"**

### 步骤 4：等待重新部署

Render 会自动重新部署服务（约 3-5 分钟）

### 步骤 5：验证配置

查看 Logs，应该看到：
```
✅ 阿里云通义千问 API 已配置
🤖 AI 识别功能: 已启用
```

---

## 💰 成本说明

### 免费额度

阿里云通义千问提供慷慨的免费额度：

- **每月**：100 万 tokens
- **有效期**：长期有效

### 个人使用估算

假设每天识别 **10 次**：

- **每次消耗**：约 1,000 tokens（图像 + 文本）
- **每天消耗**：10,000 tokens
- **每月消耗**：300,000 tokens
- **成本**：**¥0**（完全在免费额度内）

### 付费价格（超出免费额度后）

| 模型 | 输入价格 | 输出价格 |
|------|---------|---------|
| qwen-vl-plus | ¥0.008 / 千 tokens | ¥0.008 / 千 tokens |
| qwen-vl-max | ¥0.02 / 千 tokens | ¥0.02 / 千 tokens |

**每次识别成本**（使用 qwen-vl-plus）：
- 单次消耗：约 1,000 tokens
- **单次成本**：约 ¥0.008（不到 1 分钱）

**结论**：即使超出免费额度，成本也非常低！

---

## 🆚 方案对比

### 方案 1：阿里云通义千问 ⭐⭐⭐⭐⭐（推荐）

| 项目 | 说明 |
|------|------|
| **可用性** | ✅ 国内可用，无需代理 |
| **准确度** | ✅ 85-95% |
| **速度** | ✅ 1-2 秒 |
| **免费额度** | ✅ 每月 100 万 tokens |
| **成本** | ✅ 个人使用免费 |
| **配置难度** | ✅ 简单 |

### 方案 2：Google Gemini（需要代理）

| 项目 | 说明 |
|------|------|
| **可用性** | ❌ 国内无法直接访问 |
| **准确度** | ✅ 90-95% |
| **速度** | ✅ 1-2 秒 |
| **免费额度** | ✅ 每月 1,500 次请求 |
| **成本** | ✅ 个人使用免费 |
| **配置难度** | ⚠️ 需要代理 |

**注意**：Render 服务器在美国，可以直接访问 Gemini，但本地开发需要代理。

### 方案 3：传统哈希识别（默认）

| 项目 | 说明 |
|------|------|
| **可用性** | ✅ 国内外都可用 |
| **准确度** | ⚠️ 60-70% |
| **速度** | ✅ 50-200ms |
| **免费额度** | ✅ 完全免费 |
| **成本** | ✅ ¥0 |
| **配置难度** | ✅ 无需配置 |

---

## 🔧 其他国内方案

### 百度文心一言

**获取方式**：
1. 访问：https://cloud.baidu.com/product/wenxinworkshop
2. 注册百度智能云账号
3. 开通千帆大模型平台
4. 获取 API Key

**配置**：
```
AI_PROVIDER=ernie
ERNIE_API_KEY=your_api_key
```

**状态**：⚠️ 代码待实现

### 腾讯混元

**获取方式**：
1. 访问：https://cloud.tencent.com/product/hunyuan
2. 注册腾讯云账号
3. 开通混元大模型
4. 获取 API Key

**状态**：⚠️ 待支持

---

## 📱 使用方法

配置完成后，AI 识别会自动启用：

1. 打开 Cathub App
2. 点击"识别"标签
3. 拍照或选择照片
4. 系统自动使用阿里云通义千问识别
5. 显示匹配的猫咪和相似度

---

## ❓ 常见问题

### Q1: 为什么选择阿里云而不是百度？

**A**: 
- ✅ 阿里云免费额度更多（100 万 vs 5 万 tokens）
- ✅ API 更稳定
- ✅ 文档更完善
- ✅ 代码已经实现

### Q2: 需要实名认证吗？

**A**: 是的，阿里云需要实名认证（身份证）。这是国内云服务的标准要求。

### Q3: 免费额度会过期吗？

**A**: 不会！阿里云的免费额度是长期有效的。

### Q4: 可以同时配置多个 AI 服务吗？

**A**: 可以配置多个 API Key，但同时只能使用一个（通过 `AI_PROVIDER` 选择）。

### Q5: 如果 API 调用失败怎么办？

**A**: 系统会自动回退到传统哈希识别，不会影响基本功能。

### Q6: Render 服务器在国外，能访问阿里云 API 吗？

**A**: 可以！阿里云 API 支持全球访问。

### Q7: 识别速度会变慢吗？

**A**: 
- 阿里云识别：1-2 秒
- 传统哈希：50-200ms
- 对用户体验影响不大

---

## 🎯 快速开始

### 5 分钟配置步骤：

1. ✅ **注册阿里云账号**（2 分钟）
2. ✅ **开通 DashScope**（1 分钟）
3. ✅ **获取 API Key**（1 分钟）
4. ✅ **在 Render 配置环境变量**（1 分钟）
5. ✅ **等待部署完成**（3-5 分钟）

总计：**约 10 分钟**

---

## 📞 需要帮助？

如果在配置过程中遇到问题：

1. **检查日志**：在 Render Logs 中查看错误信息
2. **验证 API Key**：确保复制完整且正确
3. **检查额度**：访问阿里云控制台查看使用情况
4. **联系我**：随时告诉我遇到的问题！

---

## 🚀 下一步

配置完成后：

1. ✅ 测试识别功能
2. ✅ 对比准确度
3. ✅ 享受 AI 识别！

祝您使用愉快！🎉

